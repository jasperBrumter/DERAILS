<% provide(:title, "Tickets") %>

<div class="menupopup hidden">
<%= render "shared/navbar" %>

  <div class="menucenter">
    <div class="menucontent">
      <% unless current_user %>
        <div class="menuoption">
          <h1><%= link_to "Sign In", new_user_session_path %></h1>
        </div>
        <div class="menuoption">
          <h1><%= link_to "Sign Up", new_user_registration_path %></h1>
        </div>
        <div class="menuoption">
          <h1><%= link_to "About Us", "#" %></h1>
        </div>
      <% else %>
        <div class="menuoption">
          <h1><%= link_to "Dashboard", dashboard_path %></h1>
        </div>
        <% if current_user.is_mechanic == true  %>
        <div class="menuoption">
          <h1><%= link_to "Tickets", tickets_path %></h1>
        </div>
        <% else %>
        <div class="menuoption">
          <h1><%= link_to "New Ticket", new_ticket_path %></h1>
        </div>
        <% end %>
        <div class="menuoption">
          <h1><%= link_to "About Us", "#" %></h1>
        </div>
        <div class="menuoption">
          <h1><%= link_to "Log Out", destroy_user_session_path, method: "delete" %></h1>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div id="restofpage">
    <%= render 'shared/flashes' %>
    <%= render 'shared/navbar' %>

    <div class="secondaryinvertedbackground">

    <h1>ALL TICKETS</h1>

      <div id="map" data-markers="<%= @markers.to_json %>" data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"></div>


      <div class="ticketscontainer">
        <div class="container">
          <div class="row">
            <% @tickets.each do |ticket| %>
              <div class="col-xs-12 col-md-6">
                <div class="ticketcard">
                  <%= "TICKET # #{ticket.id}" %>
                  <p><%= ticket.address %></p>

                  <div class="filterdiv">
                    <% if ticket.tune_up == true %>
                      <span class="filter-tag">Tune-Up</span>
                    <% end %>
                    <% if ticket.brakes == true %>
                      <span class="filter-tag">Brakes</span>
                    <% end %>
                    <% if ticket.flat_tire == true %>
                      <span class="filter-tag">Flat Tire</span>
                    <% end %>
                    <% if ticket.chain == true %>
                     <span class="filter-tag">Chain</span>
                    <% end %>
                    <% if ticket.gears == true %>
                     <span class="filter-tag">Gears</span>
                    <% end %>
                    <% if ticket.wheels == true %>
                      <span class="filter-tag">Wheels</span>
                    <% end %>
                    <% if ticket.frame == true %>
                      <span class="filter-tag">Frame</span>
                    <% end %>
                  </div>


                  <%= ticket.status %>

                  <%= link_to "VIEW INFO", details_path(ticket) %>

                </div>
              </div>
            <% end %>

          </div>
        </div>
      </div>

      <%= link_to "back", dashboard_path %>

    </div>


</div>
